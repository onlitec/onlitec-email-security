# Rspamd Antivirus Configuration
# ClamAV Integration

# ClamAV scanner
clamav {
  # ClamAV socket
  servers = "onlitec_clamav:3310";
  
  # Pattern for infected messages
  patterns {
    # Adds the following symbol if ClamAV detects a virus
    CLAM_VIRUS {
      weight = 50.0;
      description = "Virus detected by ClamAV";
      one_shot = true;
    }
  }
  
  # Symbol for scan errors
  symbol {
    CLAM_VIRUS_FAIL {
      weight = 0.0;
      description = "ClamAV scan failed";
    }
  }
  
  # Scan settings
  scan_mime_parts = true;
  scan_text_mime = false;
  scan_image_mime = false;
  
  # Maximum size to scan (50MB)
  max_size = 52428800;
  
  # Timeout
  timeout = 15.0;
  
  # Retry on failure
  retransmits = 2;
  
  # Action for infected mail
  action = "reject";
  
  # Log infected files
  log_clean = false;
}
